<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <title>Custom context menu example</title>
      <link rel="shortcut icon" href="img/RootIcon.ico"/>
      <!-- To make use of RequireJS, replace following line with commented one -->
      <!--script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="scripts/JSRoot.core.js"></script-->
      <script type="text/javascript" src="../scripts/JSRoot.core.js"></script>
   </head>
   <body>
      <div id="guiDiv" path="../../files/" files="ct.root;exclusion.root;fillrandom.root;glbox.root;graph.root;hsimple.root;legends.root;rf107.root;stacks.root;zdemo.root">
         loading scripts ...
      </div>
      <script type="text/javascript">
         // build standard GUI, open ROOT file and display histogram

         let hp = null;

         JSROOT.buildGUI("guiDiv")
               .then(hpainter => { hp = hpainter; return hp.openRootFile("../../files/hsimple.root"); })
               .then(() => hp.display("hpxpy;1", "colz"));

         // assign new context menu handler for TH2 drawing
         JSROOT.require('hist').then(() => {
            JSROOT.TH2Painter.prototype.oldFillHistContextMenu = JSROOT.TH2Painter.prototype.fillHistContextMenu;

            JSROOT.TH2Painter.prototype.fillHistContextMenu = function(menu) {
               let itemname = this.getItemName();
               if ((typeof itemname == "string") && itemname.indexOf("hpxpy") >= 0) {
                  menu.add("sub:Custom", () => menu.painter.provideProjectionArea());
                  menu.add("Close extra area", () => menu.painter.provideProjectionArea());
                  menu.add("Show hpx", () => menu.painter.provideProjectionArea("X"));
                  menu.add("Show hprof", () => menu.painter.provideProjectionArea("Y"));
                  menu.add("endsub:");
               }
               console.log('Hist context menu for', this.getItemName());
               return this.oldFillHistContextMenu(menu);
            }
         });
      </script>
   </body>
</html>
